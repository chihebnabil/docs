---
title: "Post-Migration Steps"
description: "Complete your migration with these post-migration tasks"
icon: "list-check"
---

# Post-Migration Checklist

Your database has been migrated to Supabase. Now complete these steps to get your app fully operational.

## Immediate Steps (Required)

<Steps>
  <Step title="Update Environment Variables">
    Copy your environment variables from Lovable to your new Supabase project:
    
    **In Supabase Dashboard:**
    1. Go to Settings → API
    2. Scroll to "Environment Variables"
    3. Add your variables
    
    **Common variables to migrate:**
    ```bash
    # API Keys
    OPENAI_API_KEY=sk-...
    STRIPE_SECRET_KEY=sk_...
    
    # App Config
    APP_URL=https://yourapp.com
    API_BASE_URL=https://api.yourapp.com
    
    # Feature Flags
    ENABLE_BETA_FEATURES=true
    ```
    
    <Warning>
      **Update AI Provider**: If you use OpenAI, consider switching to OpenRouter for better reliability:
      ```bash
      OPENROUTER_API_KEY=sk-or-...
      ```
    </Warning>
  </Step>
  
  <Step title="Re-enable Social Auth Providers">
    OAuth connections don't transfer automatically. Reconfigure each provider:
    
    <AccordionGroup>
      <Accordion title="Google OAuth">
        1. Go to [Google Cloud Console](https://console.cloud.google.com/)
        2. Find your OAuth 2.0 credentials
        3. Add redirect URI: `https://[your-project].supabase.co/auth/v1/callback`
        4. Copy Client ID and Secret to Supabase Dashboard → Authentication → Providers
      </Accordion>
      
      <Accordion title="GitHub OAuth">
        1. Go to GitHub → Settings → Developer Settings → OAuth Apps
        2. Find your app
        3. Update Authorization callback URL: `https://[your-project].supabase.co/auth/v1/callback`
        4. Copy Client ID and Secret to Supabase
      </Accordion>
      
      <Accordion title="Apple Sign-In">
        1. Go to Apple Developer Portal
        2. Find your Services ID
        3. Update redirect URL: `https://[your-project].supabase.co/auth/v1/callback`
        4. Reconfigure in Supabase
      </Accordion>
    </AccordionGroup>
    
    **Test each provider** after configuration to ensure login works.
  </Step>
  
  <Step title="Update Your App's Supabase Client">
    Change your app to connect to the new Supabase project:
    
    ```typescript
    // lib/supabase.ts
    import { createClient } from '@supabase/supabase-js';
    
    export const supabase = createClient(
      process.env.NEXT_PUBLIC_SUPABASE_URL!, // Your new project URL
      process.env.NEXT_PUBLIC_SUPABASE_ANON_KEY! // Your new anon key
    );
    ```
    
    Update your `.env.local`:
    ```bash
    NEXT_PUBLIC_SUPABASE_URL=https://your-project.supabase.co
    NEXT_PUBLIC_SUPABASE_ANON_KEY=your-new-anon-key
    ```
  </Step>
  
  <Step title="Create New Lovable Project & Link to GitHub">
    <Warning>
      **Important**: You cannot disable the original Lovable cloud for your project. You must create a NEW Lovable project and migrate your code.
    </Warning>
    
    **Why this is necessary:**
    Lovable's architecture ties your project to their managed Supabase. To use your own Supabase instance, you need a fresh Lovable project connected to GitHub.
    
    **The Workflow:**
    
    1. **Create a New Lovable Project**
       - Go to Lovable dashboard
       - Create new project
       - Skip the template selection (or choose minimal)
    
    2. **Link to GitHub**
       - In your new Lovable project, go to Settings → GitHub Integration
       - Connect your GitHub account
       - Create a new repository (e.g., `myapp-migrated`)
       - Lovable will push initial files to this repo
    
    3. **Migrate Your Code**
       - Clone the new GitHub repo locally:
         ```bash
         git clone https://github.com/yourusername/myapp-migrated.git
         cd myapp-migrated
         ```
       - Copy your code from the old project:
         ```bash
         # From your old project directory
         cp -r src/* ../myapp-migrated/src/
         cp -r public/* ../myapp-migrated/public/
         cp package.json ../myapp-migrated/
         # Copy any other important files
         ```
       - Or use git to push from old to new:
         ```bash
         # In your old project
         git remote add new-origin https://github.com/yourusername/myapp-migrated.git
         git push new-origin main
         ```
    
    4. **Update Environment Variables in Lovable**
       - Go to your new Lovable project → Settings → Environment Variables
       - Add your Supabase credentials:
         ```bash
         NEXT_PUBLIC_SUPABASE_URL=https://your-new-project.supabase.co
         NEXT_PUBLIC_SUPABASE_ANON_KEY=your-new-anon-key
         ```
    
    5. **Update config.toml (if using Lovable's config)**
       If your project has a `config.toml` or similar Lovable-specific config, update the Supabase references:
       
       ```toml
       # config.toml
       [supabase]
       url = "https://your-new-project.supabase.co"
       anon_key = "your-new-anon-key"
       ```
       
       **Make sure to push this file to GitHub** - Lovable reads config from the repo.
    
    6. **Push to GitHub**
       ```bash
       git add .
       git commit -m "Migrate to new Supabase instance"
       git push origin main
       ```
       
       **GitHub will automatically sync to Lovable.** Your new Lovable project will now use your migrated Supabase instance instead of Lovable's managed one.
    
    7. **Verify the Connection**
       - Check Lovable's logs to ensure it's connecting to your Supabase
       - Test a database query from the Lovable preview
       - Verify auth is working with your new Supabase
  </Step>
</Steps>

## Storage Migration {#storage}

<Warning>
  **Files are NOT automatically migrated.** Follow these steps to move your storage.
</Warning>

### Option 1: Manual Upload (Recommended for < 100 files)

<Steps>
  <Step title="Create Buckets">
    In Supabase Dashboard → Storage:
    1. Create buckets matching your old structure
    2. Set public/private permissions
    3. Configure file size limits
  </Step>
  
  <Step title="Upload Files">
    Upload files via:
    - Supabase Dashboard (drag & drop)
    - Supabase CLI
    - Your own upload script
  </Step>
  
  <Step title="Update Database References">
    Update file URLs in your database:
    
    ```sql
    -- Update avatar URLs
    UPDATE profiles
    SET avatar_url = REPLACE(
      avatar_url,
      'https://old-storage-url.com/',
      'https://your-project.supabase.co/storage/v1/object/public/avatars/'
    );
    ```
  </Step>
</Steps>

### Option 2: Script-Based Migration (For 100+ files)

```typescript
// scripts/migrate-storage.ts
import { createClient } from '@supabase/supabase-js';

const OLD_SUPABASE_URL = 'https://lovable-project.supabase.co';
const OLD_SERVICE_KEY = 'old-service-key';

const NEW_SUPABASE_URL = 'https://your-project.supabase.co';
const NEW_SERVICE_KEY = 'new-service-key';

async function migrateStorage() {
  const oldClient = createClient(OLD_SUPABASE_URL, OLD_SERVICE_KEY);
  const newClient = createClient(NEW_SUPABASE_URL, NEW_SERVICE_KEY);
  
  // List all buckets
  const { data: buckets } = await oldClient.storage.listBuckets();
  
  for (const bucket of buckets || []) {
    // Create bucket in new project
    await newClient.storage.createBucket(bucket.id, {
      public: bucket.public
    });
    
    // List and download files
    const { data: files } = await oldClient.storage
      .from(bucket.id)
      .list();
    
    for (const file of files || []) {
      // Download from old
      const { data: fileData } = await oldClient.storage
        .from(bucket.id)
        .download(file.name);
      
      // Upload to new
      if (fileData) {
        await newClient.storage
          .from(bucket.id)
          .upload(file.name, fileData);
      }
    }
  }
}

migrateStorage();
```

## External API Reconfiguration

### Stripe Integration

<Steps>
  <Step title="Update Webhook Endpoint">
    In Stripe Dashboard:
    1. Go to Developers → Webhooks
    2. Update endpoint URL to your new Supabase Edge Function
    3. Update webhook secret in Supabase env vars
  </Step>
  
  <Step title="Test Payments">
    Run test transactions to ensure webhooks work
  </Step>
</Steps>

### OpenAI / AI Providers

<Steps>
  <Step title="Switch to OpenRouter (Recommended)">
    OpenRouter provides better reliability:
    
    ```typescript
    // Before
    const response = await fetch('https://api.openai.com/v1/chat/completions', {
      headers: { 'Authorization': `Bearer ${process.env.OPENAI_API_KEY}` }
    });
    
    // After (OpenRouter)
    const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
      headers: { 
        'Authorization': `Bearer ${process.env.OPENROUTER_API_KEY}`,
        'HTTP-Referer': 'https://yourapp.com'
      }
    });
    ```
  </Step>
  
  <Step title="Update Environment Variables">
    Add to Supabase Dashboard:
    ```bash
    OPENROUTER_API_KEY=sk-or-...
    ```
  </Step>
</Steps>

## Testing Checklist

Before going live, verify everything works:

<Check>
  - [ ] User can sign up with email
  - [ ] User can sign in with email
  - [ ] OAuth providers work (Google, GitHub, etc.)
  - [ ] Password reset flow works
  - [ ] Database queries return correct data
  - [ ] Edge Functions execute without errors
  - [ ] Realtime subscriptions work
  - [ ] File uploads work (if storage migrated)
  - [ ] External APIs respond correctly
  - [ ] Stripe webhooks receive events
  - [ ] AI features return responses
</Check>

## Going Live

<Steps>
  <Step title="Update Your Domain">
    Point your domain to the new deployment:
    - Update DNS records if needed
    - Configure custom domain in Vercel/Netlify
    - Update Supabase Auth redirect URLs
  </Step>
  
  <Step title="Notify Users">
    If users need to reset passwords:
    - Send email notification
    - Provide clear instructions
    - Offer magic link option
  </Step>
  
  <Step title="Monitor">
    Watch for issues:
    - Check error logs in Supabase
    - Monitor performance
    - Watch for failed auth attempts
  </Step>
</Steps>

## Troubleshooting

<AccordionGroup>
  <Accordion title=""Auth session missing">
    **Cause**: Wrong Supabase credentials or auth not configured
    
    **Fix**: Verify `NEXT_PUBLIC_SUPABASE_URL` and `NEXT_PUBLIC_SUPABASE_ANON_KEY` match your new project
  </Accordion>
  
  <Accordion title=""Database query returns empty">
    **Cause**: RLS policies blocking access
    
    **Fix**: Check RLS policies in Supabase Dashboard → Database → Tables → Policies
  </Accordion>
  
  <Accordion title=""OAuth not working">
    **Cause**: Callback URL mismatch
    
    **Fix**: Update OAuth app settings with new Supabase callback URL: `https://[project].supabase.co/auth/v1/callback`
  </Accordion>
  
  <Accordion title=""Edge Function errors">
    **Cause**: Environment variables not set
    
    **Fix**: Add all required env vars in Supabase Dashboard → Settings → API → Environment Variables
  </Accordion>
</AccordionGroup>

## Still Need Help?

<CardGroup cols={2}>
  <Card title="Self-Service Issues" href="https://github.com/chihebnabil/lovable-cloud-migration/issues" icon="github">
    Report bugs on GitHub (bugs only)
  </Card>
  
  <Card title="Complex Migrations" href="https://cal.com/chiheb-nabil/next.js-migration-help-done-for-you-service" icon="hand-holding-hand">
    Book White-Glove consultation
  </Card>
</CardGroup>
